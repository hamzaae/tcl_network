# TCL Data

## Overview
This dataset contains information about the **public transport network of Lyon (TCL)**, including stops, geographic coordinates, and the lines that serve each stop.  
It was collected from [data.grandlyon.com](https://data.grandlyon.com/) and generated using LLMS knowledge (Claude & ChatGPT) and processed to produce a **clean, structured version** suitable for graph analysis, geospatial visualization, and network modeling.

---

## Stops Data

### Raw Data
The first **raw dataset** was originally obtained in JSON format from [data.grandlyon.com](https://data.grandlyon.com/portail/fr/jeux-de-donnees/points-arret-reseau-transports-commun-lyonnais/donnees).  
Each record contained nested structures, duplicated entries, and inconsistent formatting.

You can find the raw data file here:  
`/data/raw/points-arret-reseau-transports-commun-lyonnais.json`

### Common Issues in Raw Data
- Many transport types included (bus, tram, metro) → focus needed on **base network only**.  
- Duplicates across stops (same name or address appearing multiple times).  
- Mixed formatting in the `"desserte"` column (e.g. `"A : Perrache"`, `" T1"`, `"t3"`).  
- Inconsistent case and trailing spaces.  
- Redundant or irrelevant columns for network analysis (`ascenseur`, `pmr`, etc.).  


### Raw Data Schema

| Column | Type | Description |
|:--|:--|:--|
| `id` | `int` | Unique stop identifier |
| `nom` | `string` | Stop name |
| `adresse` | `string` | Stop address |
| `commune` | `string` | Municipality of the stop |
| `insee` | `string` | INSEE code of the commune |
| `lat` | `float` | Latitude coordinate |
| `lon` | `float` | Longitude coordinate |
| `desserte` | `string` | List of lines serving the stop:A/R as Aller Retour for each csv (e.g. `A:R,T1:A,C26:A`) |
| `pmr` | `bool` | Accessibility flag (PMR access) |
| `ascenseur` | `bool` | Presence of elevator |
| `escalator` | `bool` | Presence of escalator |
| `last_update` | `datetime` | Last update date of the record |
| `zone` | `string` | Zone classification (`1, 2, 3, 4, zone exterieur`) |


### Raw Data Example Record
```json
{
  "id": 2435,
  "nom": "PD - Vivier Merle",
  "adresse": "Boulevard Vivier Merle, Lyon 3e",
  "commune": "Lyon",
  "insee": "69383",
  "lat": 45.76056,
  "lon": 4.85932,
  "desserte": "A:R,T1:A,C26:A",
  "pmr": true,
  "ascenseur": true,
  "escalator": true,
  "last_update": "2022-10-20T14:32:00Z"
}
```

### Basic Cleaning Steps Applied
1. **Zone Filtering**
   - Retained only stops within Zone 1:
2. **Column Pruning**
   - Removed unused or redundant metadata:
3. **Desserte Cleaning and Filtering**
   - Split `desserte` strings by commas.
   - Retained only **metros (A–D)** and **trams (T1, T2, …)**.
   - Removed empty entries.
   - Grouped rows having the same **stop name** or **address** to merge duplicates.
   - Merged all unique transport lines into a comma-separated string.

   ```python
   def clean_and_group_desserte(df):
       # Parse desserte
       # Keep metros (A-D) and trams (T...)
       # Group by same name or address

---

## Stops Data

### Raw Data
The second Json file was mainly generated by LLMs with high varacity considerations and same names formatting as in the original data to obtain the sequences of stops for each transport (only trams, tramBus, and Metros for simplicity and missing data after several attempts to scrap original data from official TCL website) then the data was verified mannualy to ensure its veracity

You can find the raw data file here:  
`/data/raw/trans-lines.json`

### Common Issues in Stops Data
- Some missing stops.
- Some stops names are not the same as in the first data file (e.g `Vivier Merle` vs `V. Merle`)  

### Stops Data Schema

| Column | Type | Description |
|:--|:--|:--|
| `desserte` | `string` | Transport |
| `stops` | `List[string]` | Stops names of the transport |

### Stops Data Example Record
```json
{
  "B": [
    "Charpennes Charles Hernu",
    "Brotteaux",
    "Gare Part-Dieu V.Merle",
    "Place Guichard",
    "Saxe - Gambetta",
    "Place Jean Jaurès",
    "Jean Macé",
    "Debourg",
    "Stade de Gerland Le LOU",
    "Gare d'Oullins",
    "Oullins Centre",
    "St-Genis-Laval Hôp. Sud"
  ],
}
```

----

## Cleaned Data (Final Version)
The **cleaned dataset** (`nodes_data.csv` & `edges_datav2.csv`) represents the final, structured version after full preprocessing that is concerned to be used as nodes and edges for network construction.
It contains base data (Trams T1, .., T7, TB11 & Metros A, B, C, D) and links between each.

